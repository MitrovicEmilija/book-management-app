"use strict";(self.webpackChunkmfe_user=self.webpackChunkmfe_user||[]).push([[107],{2107:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var l=a(571),r=a.n(l),s=a(4841),n=a(7536),o=a(5537);function c(){const[e,t]=(0,l.useState)(""),[a,o]=(0,l.useState)(""),c=(0,s.useNavigate)();return r().createElement("div",{className:"p-4"},r().createElement("h2",{className:"text-xl mb-4"},"Login"),r().createElement("form",{onSubmit:async t=>{t.preventDefault();try{const t=await n.A.post("http://localhost:3000/api/web/users/login",{username:e,password:a});localStorage.setItem("token",t.data.token),c("/users/dashboard")}catch(e){alert("Login failed: "+e.response?.data?.error)}},className:"space-y-4"},r().createElement("input",{type:"text",placeholder:"Username",value:e,onChange:e=>t(e.target.value),className:"border p-2 w-full"}),r().createElement("input",{type:"password",placeholder:"Password",value:a,onChange:e=>o(e.target.value),className:"border p-2 w-full"}),r().createElement("button",{type:"submit",className:"bg-blue-500 text-white p-2"},"Login")),r().createElement("p",{className:"mt-4"},"Don't have an account? ",r().createElement(s.Link,{to:"/users/register",className:"text-blue-500"},"Register here")))}function u(){const[e,t]=(0,l.useState)(""),[a,o]=(0,l.useState)(""),[c,u]=(0,l.useState)(""),m=(0,s.useNavigate)();return r().createElement("div",{className:"p-4"},r().createElement("h2",{className:"text-xl mb-4"},"Register"),r().createElement("form",{onSubmit:async t=>{t.preventDefault();try{await n.A.post("http://localhost:3000/api/web/users/register",{username:e,email:a,password:c,role:"user"}),m("/users/login")}catch(e){alert("Registration failed: "+e.response?.data?.error)}},className:"space-y-4"},r().createElement("input",{type:"text",placeholder:"Username",value:e,onChange:e=>t(e.target.value),className:"border p-2 w-full"}),r().createElement("input",{type:"email",placeholder:"Email",value:a,onChange:e=>o(e.target.value),className:"border p-2 w-full"}),r().createElement("input",{type:"password",placeholder:"Password",value:c,onChange:e=>u(e.target.value),className:"border p-2 w-full"}),r().createElement("button",{type:"submit",className:"bg-blue-500 text-white p-2"},"Register")))}function m(){const[e,t]=(0,l.useState)(null),a=(0,s.useNavigate)();return r().createElement("div",{className:"p-4"},r().createElement("h2",{className:"text-xl mb-4"},"Dashboard"),r().createElement("button",{onClick:async()=>{try{const e=localStorage.getItem("token");if(!e)throw new Error("No token found");const a=(0,o.s)(e);console.log(a);const l=a.sub;console.log(l);const r=await n.A.get(`http://localhost:3000/api/web/dashboard/${l}`,{headers:{Authorization:`Bearer ${e}`}});t(r.data)}catch(e){alert("Failed to fetch dashboard: "+(e.response?.data?.error||e.message)),a("/users/login")}},className:"bg-blue-500 text-white p-2 mb-4"},"Load Dashboard"),e&&r().createElement("div",null,r().createElement("h3",null,"User: ",e.user?.username),r().createElement("h4",null,"Books:"),r().createElement("ul",null,e.books.map((e=>r().createElement("li",{key:e.id},e.title," by ",e.author)))),r().createElement("h4",null,"Transactions:"),r().createElement("ul",null,e.transactions.map((e=>r().createElement("li",{key:e.id},e.transactionType," - Book ID: ",e.bookId))))))}const i=function(){return r().createElement(s.Routes,null,r().createElement(s.Route,{path:"/login",element:r().createElement(c,null)}),r().createElement(s.Route,{path:"/register",element:r().createElement(u,null)}),r().createElement(s.Route,{path:"/dashboard",element:r().createElement(m,null)}),r().createElement(s.Route,{path:"/",element:r().createElement(c,null)}))}}}]);