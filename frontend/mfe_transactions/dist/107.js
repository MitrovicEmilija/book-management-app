"use strict";(self.webpackChunkmfe_transactions=self.webpackChunkmfe_transactions||[]).push([[107],{2107:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});var n=a(571),r=a.n(n),o=a(4841),s=a(7536),l=a(5537);function c(){const[e,t]=(0,n.useState)([]);return(0,n.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("token");if(!e)throw new Error("No token found");const a=(0,l.s)(e).sub,n=await s.A.get(`http://localhost:3000/api/web/transactions/user/${a}`,{headers:{Authorization:`Bearer ${e}`}});t(n.data)}catch(e){alert("Failed to fetch transactions: "+(e.response?.data?.error||e.message))}})()}),[]),r().createElement("div",{className:"p-4"},r().createElement("h2",{className:"text-xl mb-4"},"Your Transactions"),r().createElement("ul",null,e.map((e=>r().createElement("li",{key:e.id,className:"mb-2"},e.transactionType," - Book ID: ",e.bookId," - ",new Date(e.createdAt).toLocaleString())))))}function u(){const[e,t]=(0,n.useState)(""),[a,o]=(0,n.useState)("BORROW"),[c,u]=(0,n.useState)("");return(0,n.useEffect)((()=>{const e=localStorage.getItem("token");if(e){const t=(0,l.s)(e);u(t.sub)}}),[]),r().createElement("div",{className:"p-4"},r().createElement("h2",{className:"text-xl mb-4"},"Create Transaction"),r().createElement("form",{onSubmit:async n=>{n.preventDefault();try{const n=localStorage.getItem("token");await s.A.post("http://localhost:3000/api/web/transactions",{userId:c,bookId:e,transactionType:a},{headers:{Authorization:`Bearer ${n}`}}),alert("Transaction created"),t(""),o("BORROW")}catch(e){alert("Failed to create transaction: "+(e.response?.data?.error||e.message))}},className:"space-y-4"},r().createElement("input",{type:"text",placeholder:"Book ID",value:e,onChange:e=>t(e.target.value),className:"border p-2 w-full"}),r().createElement("select",{value:a,onChange:e=>o(e.target.value),className:"border p-2 w-full"},r().createElement("option",{value:"BORROW"},"Borrow"),r().createElement("option",{value:"PURCHASE"},"Purchase"),r().createElement("option",{value:"RETURN"},"Return")),r().createElement("button",{type:"submit",className:"bg-blue-500 text-white p-2"},"Create")))}const m=function(){return r().createElement(o.Routes,null,r().createElement(o.Route,{path:"/",element:r().createElement(c,null)}),r().createElement(o.Route,{path:"/create",element:r().createElement(u,null)}))}}}]);