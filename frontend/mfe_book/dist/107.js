"use strict";(self.webpackChunkmfe_book=self.webpackChunkmfe_book||[]).push([[107],{2107:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});var r=a(571),o=a.n(r),l=a(4841),s=a(7536),n=a(5537);function c(){const[e,t]=(0,r.useState)([]),[a,l]=(0,r.useState)([]);return(0,r.useEffect)((()=>{(async()=>{try{const e=(await s.A.get("http://localhost:3000/api/web/books")).data,a=localStorage.getItem("token");if(!a)throw new Error("No token found");const r=(0,n.s)(a).sub,o=(await s.A.get(`http://localhost:3000/api/web/transactions/user/${r}`,{headers:{Authorization:`Bearer ${a}`}})).data,c=e.map((e=>{const t=o.filter((t=>t.bookId===e.id)).sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt)))[0],a=t&&"RETURN"!==t.transactionType?t.transactionType:"AVAILABLE";return{...e,status:a}}));t(c),l(o)}catch(e){alert("Failed to fetch books or transactions: "+(e.response?.data?.error||e.message))}})()}),[]),o().createElement("div",{className:"p-4"},o().createElement("h2",{className:"text-xl mb-4"},"Books"),o().createElement("ul",null,e.map((e=>o().createElement("li",{key:e.id,className:"mb-2"},e.title," by ",e.author," - Status: ",e.status)))))}function u(){const[e,t]=(0,r.useState)(""),[a,l]=(0,r.useState)(""),[c,u]=(0,r.useState)(""),[m,i]=(0,r.useState)("");return(0,r.useEffect)((()=>{const e=localStorage.getItem("token");if(e){const t=(0,n.s)(e);i(t.sub)}}),[]),o().createElement("div",{className:"p-4"},o().createElement("h2",{className:"text-xl mb-4"},"Create Book"),o().createElement("form",{onSubmit:async r=>{r.preventDefault();try{const r=localStorage.getItem("token");await s.A.post("http://localhost:3000/api/web/books",{title:e,author:a,isbn:c,userId:m},{headers:{Authorization:`Bearer ${r}`}}),alert("Book created"),t(""),l(""),u("")}catch(e){alert("Failed to create book: "+(e.response?.data?.error||e.message))}},className:"space-y-4"},o().createElement("input",{type:"text",placeholder:"Title",value:e,onChange:e=>t(e.target.value),className:"border p-2 w-full"}),o().createElement("input",{type:"text",placeholder:"Author",value:a,onChange:e=>l(e.target.value),className:"border p-2 w-full"}),o().createElement("input",{type:"text",placeholder:"ISBN",value:c,onChange:e=>u(e.target.value),className:"border p-2 w-full"}),o().createElement("button",{type:"submit",className:"bg-blue-500 text-white p-2"},"Create")))}const m=function(){return o().createElement(l.Routes,null,o().createElement(l.Route,{path:"/",element:o().createElement(c,null)}),o().createElement(l.Route,{path:"/create",element:o().createElement(u,null)}))}}}]);